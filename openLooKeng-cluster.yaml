---
apiVersion: v1
kind: Namespace
metadata:
  name: openlookeng
---
apiVersion: v1
kind: Service
metadata:
  name: openlookeng-server
  namespace: openlookeng
spec:
  selector:
    app: openlookeng-server
  type: NodePort
  ports:
  - port: 8080
    targetPort: 8080
    name: openlookeng
---
apiVersion: v1
kind: Pod
metadata:
  name: openlookeng-server
  namespace: openlookeng-server
  labels:
    app: openlookeng-server
  spec:
    nodeSelector:
      kubernetes.io/arch: arm64
    containers:
      - name: openlookeng-server
        image: ghcr.io/zhengzhenyu/openlookeng-arm:latest
        imagePullPolicy: Always
        ports:
        - containerPort: 8080
          name: openlookeng
        env:
          - name: IS_COORDINATOR
            value: True
          - name: INCLUDE_COORDINATOR
            value: True
          - name: HTTP_PORT
            value: 8080
          - name: DISCOVERY_URI
            value: http://localhost:8080
          - name: NODE_ENVIRONMENT
            value: openeulersummit
    restartPolicy: Always
---
apiVersion: v1
kind: Service
metadata:
  name: openlookeng-frontend
  namespace: openlookeng
spec:
  selector:
    app: openlookeng-frontend
  type: NodePort
  ports:
  - port: 8081
    targetPort: 8081
    name: airpal
---
apiVersion: v1
kind: Pod
metadata:
  name: openlookeng-frontend
  namespace: openlookeng
  labels:
    app: openlookeng-frontend
spec:
  nodeSelector:
    kubernetes.io/arch: amd64
  containers:
    - name: openlookeng-frontend
      image: ghcr.io/zhengzhenyu/airpal-ubuntu:latest
      imagePullPolicy: Always
      ports:
      - containerPort: 8081
        name: airpal
      env:
        - name: MYSQL_HOST
          value: "114.119.184.236"
        - name: PRESTO_SERVER_URI
          value: http://openlookeng-server.openlookeng.svc.cluster.local:8080
  restartPolicy: Always
